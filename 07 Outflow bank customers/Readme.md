# Прогноз оттока клиентов банка
## Задача:
<details><summary></summary>
  
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно.\
Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.\
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет.\
На основании предоставленых исторических данных о поведении клиентов и расторжении договоров с банком.\
Построить модель с предельно большим значением F1-меры.\
Дополнительно необходимо измерить AUC-ROC, сравнивая её значение с F1-мерой.
</details>

## Данные:
Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling
<details><summary>В предоставленной выборке:</summary>
  
|Признаки|Интерпретация|
|:--- |:----------- |
|`RowNumber`| — индекс строки в данных|
|`CustomerId`| — уникальный идентификатор клиента|
|`Surname`| — фамилия|
|`CreditScore`| — кредитный рейтинг|
|`Geography`| — страна проживания|
|`Gender`| — пол|
|`Age`| — возраст|
|`Tenure`| — сколько лет человек является клиентом банка|
|`Balance`| — баланс на счёте|
|`NumOfProducts`| — количество продуктов банка, используемых клиентом|
|`HasCrCard`| — наличие кредитной карты|
|`IsActiveMember`| — активность клиента|
|`EstimatedSalary`| — предполагаемая зарплата|

|Целевой признак|Интерпретация|
|:--- |:----------- |
|`Exited`| — факт ухода клиента|
</details>

## Используемые библиотеки
* pandas
* numpy
* scipy
* sklearn
* matplotlib
* seaborn
* IPython

## Отработанные методы и навыки
* Построение моделей машинного обучения;
* Улучшение качества моделей(борьба с дизбалансом классов, подбор гиперпараметров, кроссвалидация)
* Оценка качества моделей(AUC-ROC кривая);
* Проверка моделей на адекватность.
## Ключевой вывод проекта

<details><summary>В данном исследовании получены ответы на поставленные задачи Заказчика, а именно:</summary>

|Вопросы|Выводы|
|:--- |:----------- |
|Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет.<br/>На основании предоставленых исторических данных о поведении клиентов и расторжении договоров с банком.<br/>Построить модель с предельно большим значением F1-меры(порог - 0.59).<br/>Дополнительно необходимо измерить AUC-ROC, сравнивая её значение с F1-мерой.|Подобранная модель на алгоритме `RandomForestClassifier` с параметрами:<ul><li>max_depth=11</li><li>n_estimators=148</li><li>class_weight='balanced'</li></ul>превысила минимальное пороговое значение f1 меры.<br/>Значение f1 меры подобранной модели - 0,63.<br/>AUC-ROC подобранной модели - 0.85.<br/>`f1 мера` - это среднее гармоническое полноты и точности(оценивает как хорошо модели удалось прогнозирование положительного класса и не переусердствовала ли она).<br/>`AUC-ROC` оценивает вероятность того, что случайно выбранный положительный объект будет будет иметь более высокую вероятность быть положительным.<br/>`AUC-ROC` более устойчив к несбалансированным моделям нежели `f1 мера`, его показатели на первичных(несбалансированных) моделях практически не изменились, а вот показатель `f1 меры` увеличивался по мере устранения дисбаланса в данных.|
