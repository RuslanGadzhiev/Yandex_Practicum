# Восстановление золота из руды
## Задача:
<details><summary></summary>
  
Поставлена задача подготовить прототип модели машинного обучения, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды».\
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.
</details>  

## Данные:
<details><summary>В нашем распоряжении сырые данные.</summary>  

**Технологический процесс**  
`Rougher feed` — исходное сырье  
`Rougher additions` — флотационные реагенты: Xanthate, Sulphate, Depressant  
`Rougher process`  — флотация  
`Rougher tails` — отвальные хвосты  
`Float banks` — флотационная установка  
`Cleaner process` — очистка  
`Rougher Au` — черновой концентрат золота  
`Final Au` — финальный концентрат золота  
**Параметры этапов**  
`air amount` — объём воздуха  
`fluid levels` — уровень жидкости  
`feed size` — размер гранул сырья  
`feed rate` — скорость подачи  
**Наименование признаков**  
`rougher` — флотация  
`primary_cleaner` — первичная очистка  
`secondary_cleaner` — вторичная очистка  
`final` — финальные характеристики  
**Возможные значения для блока:**  
`input` — параметры сырья  
`output` — параметры продукта  
`state` — параметры, характеризующие текущее состояние этапа  
`calculation` — расчётные характеристики
</details>

## Используемые библиотеки:
* pandas
* numpy
* sklearn
* matplotlib
* seaborn

## Отработанные методы и навыки:
* Исследовательский анализ данных;
* Построение моделей машинного обучения(линейная модель, дерево решений, случайный лес);
* Улучшение качества моделей(подбор гиперпараметров, кроссвалидация);
* Оценка качества моделей(создание собственной метрики качества);
* Проверка моделей на адекватность.
## Ключевой вывод проекта

<details><summary>В данном исследовании получены ответы на поставленные задачи Заказчика, а именно:</summary>

|Вопросы|Выводы|
|:--- |:----------- |
|Подготовить прототип модели машинного обучения, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды.<br/>Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.|Была проведена предобработка данных:<ul><li>определились с целевыми признаками и признаками, необходимыми для их оценки;</li><li>удалены лишние признаки;</li><li>заполнены пропуски.</li></ul>Проведен анализ:<ul><li>Анализ концентрации металлов на различных этапах выявил прирост концентрации золота в 34%</li><li>Проведеное сравнение размеров гранул сырья в обучаемой и тестовой выборках, показало их идентичность</li><li>На этапе анализа суммарной концентрации всех веществ были выявлены и удалены аномальные значения</li></ul>На этапе построения модели:<ul><li>Выведена метрика качества sMAPE</li><li>Осуществлен выбор наиболее подходящей модели для оценки эффективной работы промышленных предприятий</li><li>Наилучшая модель проверена на тестовой выборке</li><li>Модель прошла проверку на адекватность, сравнением со "случайно" предсказывающей моделью</li></ul>Подготовлен прототип модели машинного обучения для «Цифры», предсказывающий коэффициент восстановления золота из золотосодержащей руды.<br/>Итоговая модель построена на алгоритме `RandomForestRegressor`<ul><li>Ошибка на тестовой выборке: 6.848</li><li>Параметры алгоритма: max_depth=9, n_estimators=137|
